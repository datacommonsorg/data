# US_UrbanSchool_Enrollment Import

This import focuses on urban school enrollment data across the United States. It includes data for student enrollment counts, broken down by gender, race, Limited English Proficiency, and disability status (Section 504 and Individualized Education Program).

-----

## ⚙️ Workflow

The workflow for this data import involves two main steps: downloading the necessary files and then processing them.

### Step 1: Download the Source Data

To acquire the necessary data files, execute the download script `download.py`.

```bash
python3 download.py --data_type=enrollment
```

All downloaded files will be stored in the directory `enrollment/input_files`.

-----

### Step 2: Process the Files

After successfully downloading the files, run the processing script to generate the final output artifacts. A crucial data quality filter is applied from the `pv_map` (`\#Filter,Allow=int(value) >= 0`) which ensures only non-negative counts are included in the final output. There are two ways to do this:

**Option A: Use the `run.sh` script**

The `run.sh` script automates the processing of all the downloaded files.

**Run the following command:**

```bash
sh run.sh
```

**Option B: Manually Execute the Processing Script**

#### **Execution Commands**

The final output is generated by processing the downloaded data using the stat_var_processor.py script, which is located in the data/tools/statvar_importer/ directory.

# --- 1. Process 2010 and 2014 Files (Older XLSX format) ---

# Race and Sex (2010-2014)
```bash
python3 stat_var_processor.py \
--input_data=../../../statvar_imports/us_urban_school/enrollment/input_files/*.xlsx \
--pv_map=../../../statvar_imports/us_urban_school/enrollment/race_and_sex_pvmap.csv \
--config_file=../../../statvar_imports/us_urban_school/enrollment/metadata.csv \
--existing_statvar_mcf=gs://unresolved_mcf/scripts/statvar/stat_vars.mcf \
--output_path=../../../statvar_imports/us_urban_school/enrollment/output_files/enrollment_by_race_and_sex_2010_2014_output
```

# Disability and Sex (2010-2014)
```bash
python3 stat_var_processor.py \
--input_data=../../../statvar_imports/us_urban_school/enrollment/input_files/*.xlsx \
--pv_map=../../../statvar_imports/us_urban_school/enrollment/disability_and_sex_pvmap.csv \
--config_file=../../../statvar_imports/us_urban_school/enrollment/metadata.csv \
--existing_statvar_mcf=gs://unresolved_mcf/scripts/statvar/stat_vars.mcf \
--output_path=../../../statvar_imports/us_urban_school/enrollment/output_files/enrollment_by_disability_and_sex_2010_2014_output
```

# LEP and Sex (2010-2014)
```bash
python3 stat_var_processor.py \
--input_data=../../../statvar_imports/us_urban_school/enrollment/input_files/*.xlsx \
--pv_map=../../../statvar_imports/us_urban_school/enrollment/lep_and_sex_pvmap.csv \
--config_file=../../../statvar_imports/us_urban_school/enrollment/metadata.csv \
--existing_statvar_mcf=gs://unresolved_mcf/scripts/statvar/stat_vars.mcf \
--output_path=../../../statvar_imports/us_urban_school/enrollment/output_files/enrollment_by_lep_and_sex_2010_2014_output
```

# --- 2. Process 2016 File (Separate CSV) ---

# Race and Sex (2016)
```bash
python3 stat_var_processor.py \
--input_data=../../../statvar_imports/us_urban_school/enrollment/input_files/2016_Enrollment.csv \
--pv_map=../../../statvar_imports/us_urban_school/enrollment/race_and_sex_pvmap.csv \
--config_file=../../../statvar_imports/us_urban_school/enrollment/metadata.csv \
--existing_statvar_mcf=gs://unresolved_mcf/scripts/statvar/stat_vars.mcf \
--output_path=../../../statvar_imports/us_urban_school/enrollment/output_files/enrollment_by_race_and_sex_2016_output
```

# Disability and Sex (2016)
```bash
python3 stat_var_processor.py \
--input_data=../../../statvar_imports/us_urban_school/enrollment/input_files/2016_Enrollment.csv \
--pv_map=../../../statvar_imports/us_urban_school/enrollment/disability_and_sex_pvmap.csv \
--config_file=../../../statvar_imports/us_urban_school/enrollment/metadata.csv \
--existing_statvar_mcf=gs://unresolved_mcf/scripts/statvar/stat_vars.mcf \
--output_path=../../../statvar_imports/us_urban_school/enrollment/output_files/enrollment_by_disability_and_sex_2016_output
```

# LEP and Sex (2016)
```bash
python3 stat_var_processor.py \
--input_data=../../../statvar_imports/us_urban_school/enrollment/input_files/2016_Enrollment.csv\
--pv_map=../../../statvar_imports/us_urban_school/enrollment/lep_and_sex_pvmap.csv \
--config_file=../../../statvar_imports/us_urban_school/enrollment/metadata.csv \
--existing_statvar_mcf=gs://unresolved_mcf/scripts/statvar/stat_vars.mcf \
--output_path=../../../statvar_imports/us_urban_school/enrollment/output_files/enrollment_by_lep_and_sex_2016_output
```

# --- 3. Process 2018 onwards Files (Combined CSVs, excluding 2016) ---
# Inputs: All *.csv files in input_files except 2016_Enrollment.csv
# This is dynamic and will include 2018, 2021, 2022, and any future files. This logic is applied in run.sh file.

# Race and Sex (2018 onwards)
```bash
python3 stat_var_processor.py \
--input_data=../../../statvar_imports/us_urban_school/enrollment/input_files/*.csv \
--pv_map=../../../statvar_imports/us_urban_school/enrollment/race_and_sex_pvmap.csv \
--config_file=../../../statvar_imports/us_urban_school/enrollment/metadata.csv \
--existing_statvar_mcf=gs://unresolved_mcf/scripts/statvar/stat_vars.mcf \
--output_path=../../../statvar_imports/us_urban_school/enrollment/output_files/enrollment_by_race_and_sex_2018_2022_output
```

# Disability and Sex (2018 onwards)
```bash
python3 stat_var_processor.py \
--input_data=../../../statvar_imports/us_urban_school/enrollment/input_files/*.csv \
--pv_map=../../../statvar_imports/us_urban_school/enrollment/disability_and_sex_pvmap.csv \
--config_file=../../../statvar_imports/us_urban_school/enrollment/metadata.csv \
--existing_statvar_mcf=gs://unresolved_mcf/scripts/statvar/stat_vars.mcf \
--output_path=../../../statvar_imports/us_urban_school/enrollment/output_files/enrollment_by_disability_and_sex_2018_2022_output
```

# LEP and Sex (2018 onwards)
```bash
python3 stat_var_processor.py \
--input_data=../../../statvar_imports/us_urban_school/enrollment/input_files/*.csv \
--pv_map=../../../statvar_imports/us_urban_school/enrollment/lep_and_sex_pvmap.csv \
--config_file=../../../statvar_imports/us_urban_school/enrollment/metadata.csv \
--existing_statvar_mcf=gs://unresolved_mcf/scripts/statvar/stat_vars.mcf \
--output_path=../../../statvar_imports/us_urban_school/enrollment/output_files/enrollment_by_lep_and_sex_2018_2022_output
```

### Autorefresh type

This import uses a fully automated refresh process.

