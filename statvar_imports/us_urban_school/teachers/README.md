#### Copyright 2025 Google LLC
####
#### Licensed under the Apache License, Version 2.0 (the "License");
#### you may not use this file except in compliance with the License.
#### You may obtain a copy of the License at
####
####    https://www.apache.org/licenses/LICENSE-2.0
####
#### Unless required by applicable law or agreed to in writing, software
#### distributed under the License is distributed on an "AS IS" BASIS,
#### WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#### See the License for the specific language governing permissions and
#### limitations under the License.

-----

# US_Urban_SchoolSupport_And_Staff Import

This import focuses on data about full-time equivalent (FTE) teachers and staff in urban schools across the United States.

-----

## ⚙️ Workflow

The workflow for this data import involves two main steps: downloading the necessary files and then processing them.

### Step 1: Download the Source Data

To acquire the necessary data files, execute the download script `download.py`.

```bash
python3 download.py --data_type=teachers
```

All downloaded files will be stored in the directory `teachers/input_files`.

### Autorefresh type

This import uses a fully automated refresh process.

-----

### Step 2: Process the Files

After successfully downloading the files, run the processing script to generate the final output artifacts. There are two ways to do this:

**Option A: Use the `run.sh` script**

The `run.sh` script automates the processing of all the downloaded files.

**Run the following command:**

```bash
sh run.sh
```

**Option B: Manually Execute the Processing Script**

#### **Execution Commands**

The final output is generated by processing the downloaded data using the stat_var_processor.py script, which is located in the data/tools/statvar_importer/ directory.

#### --- 1. Process 2010 and 2014 Files (Older XLSX format) ---
```bash
python3 stat_var_processor.py \
--input_data=../../../statvar_imports/us_urban_school/teachers/input_files/*.xlsx \
--pv_map=../../../statvar_imports/us_urban_school/teachers/teachers_and_staff_pvmap.csv \
--config_file=../../../statvar_imports/us_urban_school/teachers/metadata.csv \
--existing_statvar_mcf=gs://unresolved_mcf/scripts/statvar/stat_vars.mcf \
--output_path=../../../statvar_imports/us_urban_school/teachers/output_files/teachers_and_staff_2010_2014_output
```

#### --- 2. Process 2016 File (Separate CSV) ---
```bash
python3 stat_var_processor.py \
--input_data=../../../statvar_imports/us_urban_school/teachers/input_files/2016_Teachers.csv \
--pv_map=../../../statvar_imports/us_urban_school/teachers/teachers_and_staff_pvmap.csv \
--config_file=../../../statvar_imports/us_urban_school/teachers/metadata.csv \
--existing_statvar_mcf=gs://unresolved_mcf/scripts/statvar/stat_vars.mcf \
--output_path=../../../statvar_imports/us_urban_school/teachers/output_files/teachers_and_staff_2016_output
```

#### --- 3. Process 2018 onwards Files (Combined CSVs, excluding 2016) ---
```bash
python3 stat_var_processor.py \
--input_data=../../../statvar_imports/us_urban_school/teachers/input_files/*.csv \
--pv_map=../../../statvar_imports/us_urban_school/teachers/teachers_and_staff_pvmap.csv \
--config_file=../../../statvar_imports/us_urban_school/teachers/metadata.csv \
--existing_statvar_mcf=gs://unresolved_mcf/scripts/statvar/stat_vars.mcf \
--output_path=../../../statvar_imports/us_urban_school/teachers/output_files/teachers_and_staff_2018_2022_output
```
