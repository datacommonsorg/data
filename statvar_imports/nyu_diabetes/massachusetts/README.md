#### Copyright 2025 Google LLC
####
#### Licensed under the Apache License, Version 2.0 (the "License");
#### you may not use this file except in compliance with the License.
#### You may obtain a copy of the License at
####
####    https://www.apache.org/licenses/LICENSE-2.0
####
#### Unless required by applicable law or agreed to in writing, software
#### distributed under the License is distributed on an "AS IS" BASIS,
#### WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#### See the License for the specific language governing permissions and
#### limitations under the License.

-----

## NYU_Massachusetts_Diabetes Import

This import utilizes official Diabetes data from the Massachusetts Department of Health, detailing county-level diabetes statistics.

-----

### ⚙️ Workflow

The workflow for this data import involves one step: Processing file.

 **Source URL**:"https://healthdatatool.mass.gov/report-tool/?REPORT=%7B%22name%22%3A%22Massachusetts%20County%20Health%20Assessment%22%2C%22style%22%3A%22MADPH%22%2C%22contentId%22%3A%22%23cdt-report-content%22%2C%22output%22%3A%7B%22countylist%22%3Atrue%2C%22statelist%22%3Atrue%2C%22ziplist%22%3Afalse%2C%22tractlist%22%3Afalse%2C%22map%22%3Atrue%2C%22breakout%22%3Atrue%7D%2C%22indicatorUid%22%3A%5B%22285%22%5D%2C%22indicator%22%3A%5B50%5D%2C%"

#### Step 1. Manual Import
This import is **not** designed to be autorefreshed. The data is downloaded manually. Any future updates will require repeating the manual download steps.

1. From the source URL, manually extract the relevant tables/data (e.g., by copy-pasting the data).
3. Place the extracted input files in the `input_files/` directory( in gcs bucket).
4. Run the `run.sh` script to download the data from gcs bucket.
5. The downloaded data will be available in the `input_files/` directory in local.

#### Step 2: Process the Files

Run the processing script to generate the final output artifacts.

#### **Execution Commands**

The final output is generated by processing the downloaded data using the stat_var_processor.py script, which is located in the data/tools/statvar_importer/ directory.

    ```bash
    python3 stat_var_processor.py \
    --input_data=../../statvar_imports/nyu_diabetes/massachusetts/input_files/Massachusetts-Diabetes-data.csv \
    --pv_map=../../statvar_imports/nyu_diabetes/massachusetts/pvmap.csv \
    --places_resolved_csv=../../statvar_imports/nyu_diabetes/massachusetts/place_resolver.csv \
    --config_file=../../statvar_imports/nyu_diabetes/massachusetts/metadata.csv \
    --output_path=../../statvar_imports/nyu_diabetes/massachusetts/output_files/massachusetts_output \
    --existing_statvar_mcf=gs://unresolved_mcf/scripts/statvar/stat_vars.mcf
    ```
