# Importing Human-GEM Human1 data

## Table of Contents

1. [About the Dataset](#about-the-dataset)
    1. [Download URL](#download-url)
    2. [Database Overview](#database-overview)
    3. [Schema Overview](#schema-overview)
    4. [Notes and Caveats](#notes-and-caveats)
    5. [License](#license)
2. [About the Import](#about-the-import)
    1. [Scripts](#scripts)
    2. [tMCF files](#tMCF-files)
    3. [Example](#example)
    
    
## About The Dataset

### Download URL

The HumaGEM-Human1 data files (gense.tsv, metabolites.tsv, reactions.tsv, groups.tsv, geneRoles.tsv, reactantRoles.tsv, productRoles.tsv, groupMemberships.tsv), which were generated by extracting data from [Human-Gem.xml](https://github.com/SysBioChalmers/Human-GEM/blob/master/model/Human-GEM.xml) file in [Human-GEM repository](https://github.com/SysBioChalmers/Human-GEM), were obtained from [this repository](https://github.com/paul-shannon/bio-gdb/tree/main/forSam/v1). <br>
An interactive web portal for viewing Human1 data can be found [here](https://metabolicatlas.org/)

The recon-store-metabolites-1.tsv file were downloaded from [Virtual Metabolic Human database](https://www.vmh.life/#human/all): Choose "4138 metabolites found", set page site to 4138 and download the file.

### Database Overview 

This directory stores scripts and data for generating csv files which can be combined with the provided tMCF to ingest Human1 data to Data Commons knowledge graph. 

#### Data files <br>

Human1 data files can be found in ./data folder 

* Entities:

|File| Description|
---------|-----------
|genes.tsv| containing information about genes|
|metabolites.tsv| containing informaion about metabolites|
|reactions.tsv| containing information about reactions|
|groups.tsv| containing information about metabolites classification/metabolic subsytems|

* Relationships:

|File| Description|
---------|-----------
|geneRoles.tsv| indicating relationships between gene and reactions|
|reactantRoles.tsv| indicating relationships between reactions and their reatants|
|productRoles.tsv| inicating relationships between reactions and their products|
|groupMemberships.tsv| indicating relationships between reations and the subsystems they belong to|

recon-store-metabolites-1.tsv: to combine with human1 metabolites.csv to genertate the mapping between humGEMID and hmdb id.

### Schema Overview 

Human1 data contains information about the relationships between metabolites, reactions, metabolic subsystems, and proteins/genes involved in reations. <br>
The schema for Human1 data can be found in Human1.mcf and Human1_Enum.mcf. <br>

"Metabolite" class is defined as a subClass of "ChemicalCompound". It includes the following properties on tops of properties of "ChemicalCompound":
* "cellularCompartment": Enum type, include categories such as ("cellularCompartmentCytosol", "cellularCompartmentLysosomal",etc...)
* "chemicalFormula"
* "biggID"
* "metaNetXID"
* "lipidMapsID"

"MetabolicReaction" class has the following properties:
* "humanGEMID"
* "metaNetXID"
* "biggID"
* "isReactionReversible"
* "isReactionFast"
* "metabolicFluxRange"
* "enzymeCommissionNumber"
* "keggReactionID"
* "reactomeID"
* "transporterClassificationDatabaseID"
* "hierachyType": Enum type, include category such as "partonomy"

"Gene" is connected with  "MetabolicReaction" by property "geneRole", indicating enzyme participating in the reaction.

"Metabolite' is not location-specific but "MetabolicReaction" is. To connect between these 2 entities, another entity named "MetabolicCellularCompartment" is created. 
"MetabolicCellularComparment" is linked to "Metabolite" with property "associatedMetabolite". "MetabolicReaction" is linked to "MetabolicCellularCompartment" through properties: "productCellularCompartment" and "reactantCellularCompartment".

"MetabolicReactionSubsystem" class has the following properties:
* "humanGEMID"
* "systemBioOntologyTerm", which is also added to the domain of "Gene"

"MetabolicReaction" and "MetabolicReactionSubsystem" is connected by "memberOfMetabolicReactionSubsystem" property.

### Notes and Caveats

Several gene symbols were not abled to map to existing Gene dcid on Data Commons knowledge graph. Specifically, NTAQ1 couldn't be found on GenomeAssembly hg38. NTAQ1, Z83844.1, AC011462.1, AL845331.1, AC022400.5, AP000812.4, AC093512.2, AL160260.1 couldn't be found on GenomeAssembly hg19. <br>

chemblID are used as dcid for metabolites. For metabolites that lack chemblID, humanMetabolomeDatabaseID, 
MetaNetXID, nd ChemicalName were used as dcid respectively. 

### License

Creative Commons Attribution 4.0 International <br>

More information about License can be found [here](https://github.com/SysBioChalmers/Human-GEM/blob/master/LICENSE.md)

## About the Import 

Python scripts file for processing data files are stored in ./script folder <br>
Please read the description of each file for the appropriate inputs. <br>

### Scripts
|File| Description|
---------|-----------
|format_genes.py|Inputs: genes.tsv, geneRoles.tsv <br> Outputs: formatted genes.csv, geneRoles.csv|
|format_metabolites.py|Inputs: metabolites.tsv, reactants.tsv, products.tsv <br> Outputs: formatted metabolites.csv, metabolicCellularComparment, reactants.csv, products.csv|
|format_reactions.py|Inputs: reactions.tsv <br> Outputs: formatted reactions.csv|
|format_groups.py|Inputs: groups.tsv, groupMemberships.tsv<br> Outputs: formatted groups.csv, groupMemberships.tsv|
|map_human1_hmdb.py|Inputs: metabolites.tsv, 
recon-store-metabolites-1.tsv, hmdb.csv<br> Outputs: humanGEM_HMDB_map.csv|

### tMCF files

tMCF files are stored in ./tMCF folder <br>
These files can be used together with the generated .csv files to ingest human1 data to Data Commons. <br>

|File| Description|
---------|-----------
|genes.tmcf| combine with genes.csv for ingestion  |
|metabolites.tmcf| combine with metabolites.csv for ingestion  |
|reactions.tmcf| combine with reactions.csv for ingestion  |
|groups.tmcf| combine with groups.csv for ingestion  |
|geneRoles.tmcf| combine with geneRoles.csv for ingestion  |
|reactantRoles.tmcf| combine with reactantRoles.csv for ingestion  |
|productRoles.tmcf| combine with productRoles.csv for ingestion  |
|groupMemberships.tmcf| combine with groupMemberships.csv for ingestion  |
|metabolicCellularCompartment.tmcf| combine with metabolicCellularCompartment.csv for ingestion|

### Example 

To format genes.tsv and geneRoles.tsv, put the tsv files and the python script in the same directory and run:
```bash
python format_genes.py genes.tsv geneRoles.tsv
```

The formatted genes.csv and geneRoles.csv will be generated in the current directory. These csv files can be combined with its corressponding tMCF files for data ingestion to Data Commons.

Similarly, for other data files:
```bash 
python format_metabolites.py metabolites.tsv reactantRoles.tsv productRoles.tsv 
```
This will generate 4 formatted files: metabolites.csv, metabolicCellularCompartment.csv reactantRoles.csv, and productRoles.csv
```bash
python format_reactions.py reactions.tsv
```
This will generate the formatted reactions.csv file 

```bash
python format_groups.py groups.tsv groupMemberships.tsv 
```
This will generate 2 formatted files: groups.csv and groupMemberships.csv


